## 从输入URL到页面呈现发生了什么？---网络篇

### 网络请求
#### 1.构建请求
浏览器会构建请求行:
`GET / http/1.1`
#### 2.查找强缓存
先检查强缓存，如果命中直接使用，否则进入下一步。

#### 3.DNS解析
由于我们输入的是域名，而数据包是通过IP地址传给对方的。因此我们需要得到域名对应的IP地址。这个过程需要依赖一个服务系统，这个系统将域名和 IP 一一映射，我们将这个系统就叫做DNS（域名系统）。得到具体 IP 的过程就是DNS解析。
当然，值得注意的是，浏览器提供了DNS数据缓存功能。即如果一个域名已经解析过，那会把解析的结果缓存下来，下次处理直接走缓存，不需要经过 DNS解析。
另外，如果不指定端口的话，默认采用对应 IP 的 80 端口。
#### 4.建立TCP连接
> TCP（Transmission Control Protocol，传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议。

+ 通过三次握手(即总共发送3个数据包确认已经建立连接)建立客户端和服务器之间的连接。
+ 进行数据传输。这里有一个重要的机制，就是接收方接收到数据包后必须要向发送方确认, 如果发送方没有接到这个确认的消息，就判定为数据包丢失，并重新发送该数据包。当然，发送的过程中还有一个优化策略，就是把大的数据包拆成一个个小包，依次传输到接收方，接收方按照这个小包的顺序把它们组装成完整数据包。
+ 断开连接的阶段。数据传输完成，现在要断开连接了，通过四次挥手来断开连接。

可见，TCP 连接是通过什么手段来保证数据传输的可靠性，一是三次握手确认连接，二是数据包校验保证数据到达接收方，三是通过四次挥手断开连接。
#### 5.发送 HTTP 请求
TCP连接建立完毕，浏览器可以和服务器开始通信，即开始发送 HTTP 请求。浏览器发 HTTP 请求要携带三样东西:**请求行、请求头和请求体**。

注意：请求体只有在POST方法下存在，GET请求的请求参数存在于请求行的请求URL中。
#### 6.网络响应
跟请求部分类似，网络响应具有三个部分:响应行、响应头和响应体。
响应行如下：
`http/1.1 200 ok`

从HTTP/1.1起，浏览器默认都开启了connection:Keep-Alive请求头，保持连接特性，客户端和服务器都能选择随时关闭连接，则请求头中为connection:close。简单地说，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的TCP连接不会关闭，如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的TCP连接。但是Keep-Alive不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。